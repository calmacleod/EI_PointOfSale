<div id="order_customer_panel" class="border-b border-theme p-4">
  <h3 class="text-xs font-semibold uppercase tracking-wider text-muted mb-2">Customer</h3>

  <% if order.customer.present? %>
    <div class="rounded-lg border border-theme bg-surface p-3">
      <div class="flex items-start justify-between">
        <div>
          <p class="text-sm font-medium text-body"><%= order.customer.name %></p>
          <% if order.customer.member_number.present? %>
            <p class="text-xs text-muted">#<%= order.customer.member_number %></p>
          <% end %>
          <% if order.customer.tax_code.present? %>
            <p class="mt-1 text-xs text-accent">
              Tax: <%= order.customer.tax_code.name %> (<%= (order.customer.tax_code.rate * 100).round(1) %>%)
            </p>
          <% end %>
          <% if order.customer.status_card_number.present? %>
            <p class="mt-0.5 text-xs text-muted">Status Card: <%= order.customer.status_card_number %></p>
          <% end %>
          <% if order.customer.alert.present? %>
            <p class="mt-1 rounded bg-yellow-50 px-2 py-1 text-xs text-yellow-800"><%= order.customer.alert %></p>
          <% end %>
        </div>
        <% if order.draft? %>
          <%= button_to remove_customer_order_path(order), method: :delete, class: "text-muted hover:text-red-500 transition", data: { turbo_stream: true } do %>
            <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
          <% end %>
        <% end %>
      </div>
    </div>
  <% else %>
    <p class="mb-2 text-xs text-muted">No customer â€” quick sale</p>
    <% if order.draft? %>
      <button type="button"
              class="w-full rounded-md border border-dashed border-theme px-3 py-2 text-xs text-muted hover:border-accent hover:text-accent transition"
              data-action="click->order-form#openCustomerSearch">
        <svg class="inline h-3.5 w-3.5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
        Search & assign customer
      </button>
    <% end %>
  <% end %>

  <% if order.tax_exempt? %>
    <div class="mt-2 rounded-md bg-amber-50 border border-amber-200 px-3 py-1.5">
      <p class="text-xs font-semibold text-amber-800">TAX EXEMPT</p>
      <% if order.tax_exempt_number.present? %>
        <p class="text-xs text-amber-700">Card: <%= order.tax_exempt_number %></p>
      <% end %>
    </div>
  <% end %>
</div>
