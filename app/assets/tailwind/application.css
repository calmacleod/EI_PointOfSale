@import "tailwindcss";

/* Theme system: data-theme and data-font-size on html */
:root,
[data-theme="light"] {
  --color-page: #f8fafc;
  --color-surface: #ffffff;
  --color-border: #e2e8f0;
  --color-text: #0f172a;
  --color-text-muted: #64748b;
  --color-accent: #0f172a;
  --color-accent-hover: #1e293b;
  --color-success-bg: #ecfdf5;
  --color-success-border: #a7f3d0;
  --color-success-text: #065f46;
  --color-error-bg: #fef2f2;
  --color-error-border: #fecaca;
  --color-error-text: #991b1b;
}

[data-theme="dark"] {
  --color-page: #0f172a;
  --color-surface: #1e293b;
  --color-border: #334155;
  --color-text: #f1f5f9;
  --color-text-muted: #94a3b8;
  --color-accent: #f1f5f9;
  --color-accent-hover: #e2e8f0;
  --color-success-bg: #064e3b;
  --color-success-border: #047857;
  --color-success-text: #a7f3d0;
  --color-error-bg: #7f1d1d;
  --color-error-border: #b91c1c;
  --color-error-text: #fecaca;
}

[data-theme="dim"] {
  --color-page: #1e293b;
  --color-surface: #334155;
  --color-border: #475569;
  --color-text: #e2e8f0;
  --color-text-muted: #94a3b8;
  --color-accent: #e2e8f0;
  --color-accent-hover: #f1f5f9;
  --color-success-bg: #064e3b;
  --color-success-border: #047857;
  --color-success-text: #a7f3d0;
  --color-error-bg: #7f1d1d;
  --color-error-border: #b91c1c;
  --color-error-text: #fecaca;
}

/* Font size scaling */
html {
  font-size: 16px;
}

[data-font-size="large"] {
  font-size: 18px;
}

[data-font-size="xlarge"] {
  font-size: 20px;
}

/* Semantic utility classes */
@layer components {
  .bg-page { background-color: var(--color-page); }
  .bg-surface { background-color: var(--color-surface); }
  .text-body { color: var(--color-text); }
  .text-muted { color: var(--color-text-muted); }
  .border-theme { border-color: var(--color-border); }
  .bg-accent { background-color: var(--color-accent); }
  .hover\:bg-accent:hover { background-color: var(--color-accent-hover); }
  .text-accent { color: var(--color-accent); }
  .hover\:text-accent:hover { color: var(--color-accent); }
}

/* Form inputs: thin border + subtle shadow, 6px radius for softer feel */
.input-field {
  background-color: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: 6px;
  color: var(--color-text);
  padding: 0.5rem 0.75rem;
  box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  transition: border-color 0.15s ease, box-shadow 0.15s ease;
}
.input-field::placeholder {
  color: var(--color-text-muted);
}
.input-field:focus {
  outline: none;
  border-color: var(--color-accent);
  /* 1px solid accent ring + intense shadow */
  box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05), 0 0 0 1px var(--color-accent), 0 4px 12px 2px rgb(0 0 0 / 0.2);
}

/* Form cards: softer corners for clean low-DPI rendering */
.form-card {
  border-radius: 0.5rem; /* 8px - renders cleanly on most screens */
}

/* Confirm modal: subtle open animation */
.confirm-modal-overlay > div:first-of-type {
  transition: opacity 0.15s ease-out;
}
.confirm-modal-overlay .form-card {
  animation: confirm-modal-scale-in 0.2s ease-out;
}
@keyframes confirm-modal-scale-in {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* Sidebar: scrollable nav with fixed top/bottom */
.sidebar-nav {
  overscroll-behavior: contain;
  min-width: 0;
}

/* Nav links: allow shrinking so text truncates instead of growing the button */
.nav-link {
  min-width: 0;
}

/* Sidebar: mini mode on desktop when collapsed */
@media (min-width: 1024px) {
  .sidebar-mini {
    width: 4rem; /* 64px - icons only */
    min-width: 4rem;
  }
  /* Fixed header padding on desktop - same in both states so EI logo never moves */
  .sidebar-mini > div > div:first-child,
  .sidebar-expanded > div > div:first-child {
    padding-left: 0.75rem;
    padding-right: 0.75rem;
  }
  .sidebar-mini .sidebar-text {
    overflow: hidden;
    width: 0;
    min-width: 0;
    opacity: 0;
    visibility: hidden;
    padding: 0;
    margin: 0;
    transition: none;
  }
  /* Text hidden only after width transition (sidebar-mini-hide-text added via JS) */
  .sidebar-mini.sidebar-mini-hide-text .sidebar-brand .sidebar-text {
    display: none;
  }
  .sidebar-mini.sidebar-mini-hide-text .nav-link .sidebar-text {
    display: none;
  }
  .sidebar-mini.sidebar-mini-hide-text .sidebar-sign-out-text {
    display: none;
  }
  /* Brand stays left-aligned - centering would shift logo when text hides */
  .sidebar-mini .sidebar-brand {
    flex: 1;
  }
  .sidebar-mini.sidebar-mini-hide-text .nav-link {
    justify-content: center;
    padding-left: 0.75rem;
    padding-right: 0.75rem;
  }
  /* During collapse transition: keep all text visible, preserve layout (override general .sidebar-text rules) */
  .sidebar-mini:not(.sidebar-mini-hide-text) .sidebar-brand .sidebar-text {
    width: auto;
    min-width: 0;
    flex: 1;
    overflow: hidden;
    opacity: 1;
    visibility: visible;
    padding: 0;
    margin: 0;
  }
  .sidebar-mini:not(.sidebar-mini-hide-text) .nav-link .sidebar-text {
    width: auto;
    min-width: 0;
    overflow: hidden;
    opacity: 1;
    visibility: visible;
    padding: 0;
    margin: 0;
  }
  .sidebar-mini .expand-icon {
    display: block !important;
  }
  .sidebar-mini .collapse-icon {
    display: none !important;
  }
}

/* Pagy 43 pagination: theme-aware styling */
.pagy-nav .pagy {
  --spacing: 0.25rem;
  --padding: 0.75rem;
  --rounding: 0.5rem;
  --border-width: 1px;
  --text: var(--color-text);
  --text-hover: var(--color-text);
  --text-current: var(--color-page);
  --background: var(--color-surface);
  --background-hover: var(--color-border);
  --background-current: var(--color-accent);
  --background-input: var(--color-surface);
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: center;
  gap: var(--spacing);
  font-size: 0.9375rem;
  font-weight: 500;
}
.pagy-nav .pagy a:not([role="separator"]) {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 2.5rem;
  min-width: 2.5rem;
  padding: 0 0.75rem;
  text-decoration: none;
  background-color: var(--background);
  border: var(--border-width) solid var(--color-border);
  border-radius: var(--rounding);
  color: var(--text);
  transition: background-color 0.15s ease, border-color 0.15s ease;
}
.pagy-nav .pagy a[href]:hover {
  background-color: var(--background-hover);
  color: var(--text-hover);
}
.pagy-nav .pagy a:not([href]) {
  cursor: default;
  opacity: 0.6;
}
.pagy-nav .pagy a[aria-current] {
  background-color: var(--background-current);
  color: var(--text-current);
  border-color: var(--color-accent);
}
/* Per-page select */
.pagy-limit-selector select {
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2364748b' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 0.75rem center;
  padding-right: 2rem;
}
